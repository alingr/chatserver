

<!doctype html>
<html>
  <head>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
    	<title>Socket.io Chat</title>
	<script src="/socket.io/socket.io.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
  </head>
  <body>
	
	<script>
		var socket;
		var firstconnect = true;
		
	    function connect() {
			var username = $('#username').val();
			if(username.length == 0){
				username = "Guest";
			}
			if(firstconnect) {
	        	socket = io.connect(null);
				

	
				// Callbacks for standard socket.io server events
	        	socket.on('connect', function(){ $('#status').html('Connected to Server'); });
	        	socket.on('disconnect', function(){ $('#status').html('Disconnected from Server'); });
	        	socket.on('reconnecting', function( nextRetry ){ $('#status').html('Reconnecting in ' + nextRetry + ' milliseconds');  });
	        	socket.on('reconnect_failed', function(){ $('#status').html('Reconnect Failed'); });

	        	// Callback for the 'chat' event we have defined
	        	socket.on('chat', function (client, message) { 
		 			$('#messages').append('<b> Client '+ message.msgUser + ' says:</b> ' + message.msgText + '<br>');
				});
				
				firstconnect = false;
			}
			else {
				socket.socket.reconnect();
			}
		}
		
		function disconnect() {
		    socket.disconnect();
		}
		
		function send() {
			var msg = {
    			msgText:$('#message').val(),
    			msgUser:$('#username').val()
			};
		    socket.send(msg);    
			$('#message').val('');
		};
		
		
	</script>
	
	<h1>Socket.io Chat</h1>
	<div><p id="status">Waiting for input</p></div>
	
	<br>Please enter your username: 
	<br><input id="username"></input><br>
	<div id="errorMessage"></input>
	
	<button id="connect" onClick='connect()'/>Connect</button>
	<button id="disconnect" onClick='disconnect()'>Disconnect</button><br><br>
	<input id="message"></input>
	<button id="send" onClick='send()'/>Send Message</button>
	<br>
	<br>Messages:<br><br>
	<div id="messages"></div>

  </body>
</html>
